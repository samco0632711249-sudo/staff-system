<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Staff Master System V8.1</title>
    <style>
        :root { --primary: #1e3a8a; --bg-gradient: linear-gradient(135deg, #3b82f6 0%, #2dd4bf 100%); }
        body { font-family: 'Kanit', sans-serif; background: var(--bg-gradient); background-attachment: fixed; margin: 0; padding: 10px; display: flex; justify-content: center; min-height: 100vh; }
        .container { max-width: 500px; width: 100%; background: rgba(255, 255, 255, 0.98); padding: 15px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); position: relative; }
        h2 { color: var(--primary); text-align: center; font-size: 17px; margin: 5px 0; }
        .btn-settings { position: absolute; right: 15px; top: 15px; background: #f1f5f9; padding: 5px; border-radius: 8px; cursor: pointer; border: 1px solid #e2e8f0; font-size: 14px; }
        .date-display { text-align: center; color: #1e40af; font-weight: 600; margin-bottom: 10px; background: #e0f2fe; padding: 5px; border-radius: 8px; font-size: 13px; }
        
        /* ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ï‡πâ‡∏° OT ‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î */
        .section { background: #f0fdf4; border-left: 4px solid #22c55e; border-radius: 12px; padding: 10px; margin-bottom: 10px; }
        .ot-group { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; } /* ‡πÅ‡∏ö‡πà‡∏á 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏µ‡πà */
        .ot-row { display: flex; align-items: center; justify-content: space-between; background: white; padding: 4px 10px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .ot-name { font-size: 12px; color: #334155; }
        .ot-controls { display: flex; align-items: center; gap: 5px; }
        .btn-ot { width: 22px; height: 22px; border-radius: 50%; border: none; color: white; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; }
        .btn-plus { background: #22c55e; }
        .btn-minus { background: #ef4444; }
        .ot-val { font-weight: bold; color: #1e3a8a; min-width: 15px; text-align: center; font-size: 13px; }

        .holiday-toggle-bar { display: flex; align-items: center; justify-content: space-between; background: #fffbeb; border: 1px solid #fcd34d; padding: 10px 15px; border-radius: 12px; margin-bottom: 10px; cursor: pointer; }
        .toggle-switch { width: 38px; height: 18px; background: #cbd5e1; border-radius: 50px; position: relative; transition: 0.3s; }
        .toggle-switch::before { content: ""; width: 14px; height: 14px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.3s; }
        .holiday-toggle-bar.active .toggle-switch { background: #f59e0b; }
        .holiday-toggle-bar.active .toggle-switch::before { left: 22px; }

        .staff-row { display: grid; grid-template-columns: 85px 1fr 1fr; gap: 5px; padding: 8px 0; border-bottom: 1px solid #f1f5f9; align-items: center; }
        .staff-name { font-weight: 500; font-size: 13px; color: #334155; }
        select, .locked { width: 100%; padding: 6px; border-radius: 8px; border: 1px solid #cbd5e1; font-family: 'Kanit'; font-size: 11px; outline: none; background: white; box-sizing: border-box; }
        .locked.is-holiday { background: #fff5f5; color: #e03131; border-color: #ffc9c9; text-align: center; font-weight: bold; }
        .locked.special-point { background: #e0f2fe; color: #0369a1; border-color: #7dd3fc; text-align: center; font-weight: bold; }
        .btn-copy { width: 100%; padding: 15px; background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%); color: white; border: none; border-radius: 15px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .settings-panel { display: none; text-align: center; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <div id="mainView">
        <div class="btn-settings" onclick="toggleView()">‚öôÔ∏è</div>
        <h2>‚ú® ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‚ú®</h2>
        <div id="dateDisplay" class="date-display"></div>

        <div class="section">
            <div style="font-weight: 600; color: #166534; font-size: 13px; margin-bottom:8px;">üè† ‡πÅ‡∏ï‡πâ‡∏° OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏∞‡∏™‡∏°:</div>
            <div id="otContainer" class="ot-group"></div>
        </div>

        <div id="holidayBar" class="holiday-toggle-bar" onclick="toggleHoliday()">
            <span style="font-weight: 600; color: #92400e; font-size: 13px;">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå üö©</span>
            <div class="toggle-switch"></div>
        </div>

        <div id="staffList"></div>
        <button class="btn-copy" onclick="copyResult()">üöÄ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡πà‡∏á LINE üöÄ</button>
    </div>

    <div id="settingsView" class="settings-panel">
        <h2 style="font-size: 16px;">üõ†Ô∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
        <p style="font-size: 12px; color:#64748b;">(‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏£‡∏∑‡∏≠ LocalStorage)</p>
        <button class="btn-copy" style="background:#64748b;" onclick="toggleView()">üíæ ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
</div>

<script>
let mainStaff = ["‡∏ö‡∏∏‡∏ç‡∏ï‡∏≤", "‡∏ö‡∏¥‡∏ß", "‡∏ô‡∏≤‡∏ß‡∏¥‡∏ô", "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤", "‡∏ß‡∏±‡∏î", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏û‡∏•", "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥", "‡πÇ‡∏ã‡πà‡∏™‡∏∏", "‡∏≠‡∏∏‡πÑ‡∏£"];
let holidayDB = {
    0: ["‡∏™‡∏°‡∏±‡∏¢", "‡∏™‡∏∏‡∏ô‡∏ó‡∏£‡∏µ", "‡∏ä‡∏±‡∏ä‡∏ä‡∏±‡∏¢", "‡∏Ç‡∏±‡∏ô‡∏ò‡∏∞‡∏•‡∏µ", "‡∏à‡∏¥‡∏£‡∏™‡∏∏‡∏î‡∏≤", "‡∏≠‡∏¥‡πà‡∏°‡∏ï‡∏µ‡πâ", "‡∏ï‡∏¥‡∏°", "‡∏£‡∏≤‡∏ì‡∏µ", "‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏†‡∏±‡∏ó‡∏£", "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥"], 
    1: ["‡∏ä‡∏•‡∏ò‡∏¥‡∏ä‡∏≤", "‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏†‡∏≤", "‡πÄ‡∏à‡∏≤‡∏∞", "‡∏•‡∏≥‡∏û‡∏π‡∏ô", "‡∏™‡∏∏‡∏ß‡∏±‡∏ô‡∏ô‡∏≤", "‡∏ä‡∏ô‡∏±‡∏ç‡∏ä‡∏¥‡∏ï‡∏≤", "‡∏≠‡∏ô‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå", "‡∏ô‡πâ‡∏≠‡∏á‡∏•‡∏±‡∏î"], 
    2: ["‡∏õ‡∏≤‡∏ì‡∏¥‡∏®‡∏£‡∏≤", "‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡∏≤", "‡∏™‡∏∏‡∏Å‡∏±‡∏ç‡∏ç‡∏≤", "‡πÄ‡∏û‡∏µ‡∏¢‡∏ö", "‡∏ß‡∏∏‡∏í‡∏¥", "‡∏õ‡∏£‡∏¥‡∏¢‡∏ô‡∏∏‡∏ä", "‡∏≠‡∏≤‡∏ó", "‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏≤", "‡∏´‡∏ô‡∏π‡∏ô‡∏¥‡∏î", "‡∏à‡∏¥‡∏î‡∏≤‡∏†‡∏≤", "‡∏à‡∏¥‡∏ï‡∏£‡∏û‡∏á‡∏©‡πå"], 
    3: ["‡πÅ‡∏û‡∏á‡∏®‡∏£‡∏µ", "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤", "‡∏û‡∏•", "‡∏ó‡∏≠‡∏á‡∏™‡∏π‡∏ô", "‡∏õ‡∏£‡∏∞‡πÑ‡∏û", "‡∏õ‡∏£‡∏∞‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÅ‡∏™‡∏á", "‡∏ò‡∏ß‡∏±‡∏ä", "‡∏õ‡∏£‡∏≤‡πÇ‡∏°‡∏ó‡∏¢‡πå", "‡∏™‡∏∏‡∏ä‡∏≤‡∏î‡∏≤", "‡∏≠‡∏ô‡∏á‡∏Ñ‡πå", "‡∏ß‡∏£‡∏£‡∏ï‡∏≤‡∏†‡∏≤", "‡∏û‡∏¥‡∏°‡∏ß‡∏î‡∏µ"], 
    4: ["‡πÅ‡∏≠‡πä‡∏∞‡πÅ‡∏≠‡πä‡∏∞", "‡∏ì‡∏¥‡∏ä‡∏≤‡∏î‡∏≤", "‡∏™‡∏°‡∏™‡∏≤‡∏¢", "‡∏™‡∏µ‡∏ô‡∏ß‡∏•", "‡∏î‡∏≤‡∏î‡πâ‡∏≤", "‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢", "‡∏•‡∏±‡∏î‡∏î‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏ö‡∏¥‡∏ß", "‡∏ô‡∏≤‡∏ß‡∏¥‡∏ô"], 
    5: ["‡∏Å‡∏£‡∏£‡∏ì‡∏¥‡∏Å‡∏≤", "‡∏ô‡πâ‡∏≥‡∏≠‡πâ‡∏≠‡∏¢", "‡∏ô‡∏¥‡∏î", "‡∏ã‡∏π‡∏•‡∏Å‡∏¥‡∏ü‡∏•‡∏µ", "‡∏ú‡πà‡∏≠‡∏á‡∏®‡∏£‡∏µ", "‡πÅ‡∏™‡∏á", "‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "‡∏ö‡∏∏‡∏ç‡∏ï‡∏≤", "‡∏û‡∏•‡∏≤‡∏Å‡∏£", "‡∏•‡∏≠‡∏¢"], 
    6: ["‡∏ß‡∏±‡∏î", "‡∏™‡∏≤‡∏¢‡πÉ‡∏à", "‡πÄ‡∏Ç‡∏°‡∏¥‡∏Å‡∏≤", "‡∏¢‡∏∏‡∏ß‡∏î‡∏µ", "‡∏ô‡∏¥‡∏ï‡∏¢‡∏≤", "‡∏õ‡∏∏‡πâ‡∏°", "‡∏ô‡∏¥‡∏î‡∏≤", "‡∏•‡∏≥‡∏î‡∏ß‡∏ô", "‡πÇ‡∏ã‡πà‡∏™‡∏∏", "‡∏≠‡∏∏‡πÑ‡∏£"]
};

const timeSlots = ["07:00 - 19:00", "08:00 - 20:00", "09:00 - 21:00", "09:30 - 20:30", "09:30 - 21:30", "10:00 - 22:00"];
let otHistory = JSON.parse(localStorage.getItem('ot_v8.1')) || {};
let isHoliday = false;

function toggleView() {
    const main = document.getElementById('mainView');
    const settings = document.getElementById('settingsView');
    if (main.style.display === 'none') { main.style.display = 'block'; settings.style.display = 'none'; }
    else { main.style.display = 'none'; settings.style.display = 'block'; }
}

function toggleHoliday() {
    isHoliday = !isHoliday;
    document.getElementById('holidayBar').classList.toggle('active', isHoliday);
    renderList();
}

function updateOT(name, val) {
    otHistory[name] = Math.max(0, (otHistory[name] || 0) + val);
    localStorage.setItem('ot_v8.1', JSON.stringify(otHistory));
    renderList();
}

function renderList() {
    const today = new Date();
    const day = today.getDay();
    document.getElementById('dateDisplay').innerText = `üìÖ ${today.toLocaleDateString('th-TH', {weekday:'long', day:'numeric', month:'long', year:'numeric'})}`;

    let otHtml = '';
    mainStaff.forEach(n => {
        let count = otHistory[n] || 0;
        otHtml += `
            <div class="ot-row">
                <span class="ot-name">${n}</span>
                <div class="ot-controls">
                    <button class="btn-ot btn-minus" onclick="updateOT('${n}', -1)">-</button>
                    <span class="ot-val">${count}</span>
                    <button class="btn-ot btn-plus" onclick="updateOT('${n}', 1)">+</button>
                </div>
            </div>`;
    });
    document.getElementById('otContainer').innerHTML = otHtml;

    let html = '';
    mainStaff.forEach(name => {
        let currentPoint = "‡∏ß‡πà‡∏≤‡∏á";
        let isLocked = false;
        let lockClass = "locked is-holiday";

        if (holidayDB[day] && holidayDB[day].includes(name)) { currentPoint = "üè† ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô"; isLocked = true; }
        if (name === "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤" && isHoliday) { currentPoint = "‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A"; isLocked = true; lockClass = "locked special-point"; }
        if (name === "‡∏û‡∏•" && !isLocked) { currentPoint = "3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞"; }
        if (name === "‡∏ß‡∏±‡∏î" && !isLocked) currentPoint = "2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞";
        if (name === "‡πÇ‡∏ã‡πà‡∏™‡∏∏" && (day !== 0 && day !== 6) && !isLocked) currentPoint = "2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞";

        html += `
        <div class="staff-row" data-name="${name}">
            <div class="staff-name">üë§ ${name}</div>
            <div>
                ${isLocked ? `<div class="${lockClass}">${currentPoint}</div>` : `
                <select class="point-sel" onchange="handleSelectChange(this)">
                    <option value="‡∏ß‡πà‡∏≤‡∏á" ${currentPoint==='‡∏ß‡πà‡∏≤‡∏á'?'selected':''}>‚ö™ ‡∏ß‡πà‡∏≤‡∏á</option>
                    <option value="2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞" ${currentPoint==='2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞'?'selected':''}>üöõ 2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞</option>
                    <option value="3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞" ${currentPoint==='3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞'?'selected':''}>üöõ 3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞</option>
                    <option value="2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞" ${currentPoint==='2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞'?'selected':''}>üöú 2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞</option>
                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A" ${currentPoint==='‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A'?'selected':''}>üöΩ ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A</option>
                    <option value="üè† ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô">üè† ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô</option>
                </select>`}
            </div>
            <div class="time-container">
                ${(isLocked && currentPoint.includes("‡∏´‡∏¢‡∏∏‡∏î")) ? '<div style="text-align:center">-</div>' : `
                <select class="time-sel">
                    ${timeSlots.map(t => `<option value="${t} ‚è∞">${t} ‚è∞</option>`).join('')}
                </select>`}
            </div>
        </div>`;
    });
    document.getElementById('staffList').innerHTML = html;
}

function handleSelectChange(select) {
    const row = select.closest('.staff-row');
    const timeContainer = row.querySelector('.time-container');
    if (select.value === "üè† ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô") {
        timeContainer.innerHTML = '<div style="text-align:center">-</div>';
    } else {
        timeContainer.innerHTML = `<select class="time-sel">${timeSlots.map(t => `<option value="${t} ‚è∞">${t} ‚è∞</option>`).join('')}</select>`;
    }
}

function copyResult() {
    const today = new Date();
    let text = `üíé ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô üíé\nüìÖ ‡∏ß‡∏±‡∏ô${today.toLocaleDateString('th-TH', {weekday:'long', day:'numeric', month:'long', year:'numeric'})}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n`;
    document.querySelectorAll('.staff-row').forEach((row, i) => {
        const name = row.querySelector('.staff-name').innerText;
        const lockDiv = row.querySelector('.locked');
        const point = lockDiv ? lockDiv.innerText : row.querySelector('.point-sel').value;
        const timeSel = row.querySelector('.time-sel');
        const time = timeSel ? timeSel.value : "-";
        if (point.includes('‡∏´‡∏¢‡∏∏‡∏î')) text += `${i+1}. ${name} ‚ûî [ ${point} ]\n\n`;
        else text += `${i+1}. ${name} ‚ûî ${point} (${time})\n\n`;
    });
    navigator.clipboard.writeText(text).then(() => alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! üöÄ"));
}
renderList();
</script>
</body>
</html>
