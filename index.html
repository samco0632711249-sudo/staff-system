<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Staff Master System - Full View</title>
    <style>
        :root { --primary: #1e3a8a; --bg-gradient: linear-gradient(135deg, #3b82f6 0%, #2dd4bf 100%); }
        body { font-family: 'Kanit', sans-serif; background: var(--bg-gradient); background-attachment: fixed; margin: 0; padding: 15px; display: flex; justify-content: center; min-height: 100vh; }
        .container { max-width: 550px; width: 100%; background: rgba(255, 255, 255, 0.98); padding: 25px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); position: relative; height: fit-content; }
        h2 { color: var(--primary); text-align: center; font-size: 19px; margin: 0 0 10px 0; }
        .btn-settings { position: absolute; right: 25px; top: 25px; background: #f1f5f9; padding: 8px; border-radius: 12px; cursor: pointer; border: 1px solid #e2e8f0; }
        .date-display { text-align: center; color: #1e40af; font-weight: 600; margin-bottom: 15px; background: #e0f2fe; padding: 8px; border-radius: 10px; font-size: 15px; }
        .section { background: #f0fdf4; border-left: 5px solid #22c55e; border-radius: 15px; padding: 15px; margin-bottom: 15px; }
        .ot-group { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .ot-chip { cursor: pointer; background: white; border: 1px solid #cbd5e1; padding: 7px 14px; border-radius: 50px; font-size: 13px; display: flex; align-items: center; gap: 5px; }
        .ot-chip.active { background: #dcfce7; border-color: #22c55e; color: #15803d; font-weight: bold; }
        .ot-count { background: #22c55e; color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 10px; }
        .holiday-toggle-bar { display: flex; align-items: center; justify-content: space-between; background: #fffbeb; border: 2px solid #fcd34d; padding: 15px; border-radius: 18px; margin-bottom: 15px; cursor: pointer; }
        .toggle-switch { width: 45px; height: 22px; background: #cbd5e1; border-radius: 50px; position: relative; transition: 0.3s; }
        .toggle-switch::before { content: ""; width: 16px; height: 16px; background: white; border-radius: 50%; position: absolute; top: 3px; left: 3px; transition: 0.3s; }
        .holiday-toggle-bar.active .toggle-switch { background: #f59e0b; }
        .holiday-toggle-bar.active .toggle-switch::before { left: 26px; }
        .staff-row { display: grid; grid-template-columns: 100px 1fr 1fr; gap: 8px; padding: 10px 0; border-bottom: 1px solid #f1f5f9; align-items: center; }
        .staff-name { font-weight: 500; font-size: 14px; color: #334155; }
        select, .locked { width: 100%; padding: 8px; border-radius: 10px; border: 1px solid #cbd5e1; font-family: 'Kanit'; font-size: 12px; outline: none; background: white; box-sizing: border-box; }
        .locked.is-holiday { background: #fff5f5; color: #e03131; border-color: #ffc9c9; text-align: center; font-weight: bold; }
        .locked.special-point { background: #e0f2fe; color: #0369a1; border-color: #7dd3fc; text-align: center; font-weight: bold; }
        .btn-copy { width: 100%; padding: 18px; background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%); color: white; border: none; border-radius: 20px; font-size: 17px; font-weight: bold; cursor: pointer; margin-top: 15px; }
        .settings-panel { display: none; }
        .input-group { display: flex; gap: 5px; margin-top: 10px; }
        input { flex: 1; padding: 10px; border-radius: 10px; border: 1px solid #cbd5e1; font-family: 'Kanit'; }
        .btn-add { background: #22c55e; color: white; border: none; padding: 10px 15px; border-radius: 10px; cursor: pointer; }
        .btn-back { background: #64748b; color: white; border: none; padding: 15px; border-radius: 20px; width: 100%; margin-top: 10px; cursor: pointer; font-weight: bold; }
        .list-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #f1f5f9; font-size: 14px; }
        .btn-del { color: #ef4444; cursor: pointer; font-weight: bold; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <div id="mainView">
        <div class="btn-settings" onclick="toggleView()">‚öôÔ∏è</div>
        <h2>‚ú® ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‚ú®</h2>
        <div id="dateDisplay" class="date-display"></div>

        <div class="section">
            <div style="font-weight: 600; color: #166534; font-size: 14px;">üè† ‡πÅ‡∏ï‡πâ‡∏° OT ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏∞‡∏™‡∏°: <span style="font-weight:normal; font-size:11px;">(‡∏Ñ‡∏•‡∏¥‡∏Å=‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏Ñ‡πâ‡∏≤‡∏á=‡∏•‡∏î)</span></div>
            <div id="otContainer" class="ot-group"></div>
        </div>

        <div id="holidayBar" class="holiday-toggle-bar" onclick="toggleHoliday()">
            <span style="font-weight: 600; color: #92400e;">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå üö©</span>
            <div class="toggle-switch"></div>
        </div>

        <div id="staffList"></div>
        <button class="btn-copy" onclick="copyResult()">üöÄ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡πà‡∏á LINE üöÄ</button>
    </div>

    <div id="settingsView" class="settings-panel">
        <h2 style="font-size: 16px;">üõ†Ô∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å üë•</h2>
        <div id="mainStaffSettings"></div>
        <div class="input-group">
            <input type="text" id="newMainStaff" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà...">
            <button class="btn-add" onclick="addItem('main')">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠</button>
        </div>

        <h2 style="font-size: 16px; margin-top: 25px;">üìÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô üóìÔ∏è</h2>
        <select id="daySelect" onchange="renderSettings()" style="margin-bottom: 10px; font-size: 14px;"></select>
        <div id="holidaySettings"></div>
        <div class="input-group">
            <input type="text" id="newHolidayStaff" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ...">
            <button class="btn-add" style="background: #3b82f6;" onclick="addItem('holiday')">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</button>
        </div>
        <button class="btn-back" onclick="toggleView()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å ‚úÖ</button>
    </div>
</div>

<script>
// ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
let mainStaff = JSON.parse(localStorage.getItem('mainStaff_V7')) || ["‡∏ö‡∏∏‡∏ç‡∏ï‡∏≤", "‡∏ö‡∏¥‡∏ß", "‡∏ô‡∏≤‡∏ß‡∏¥‡∏ô", "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤", "‡∏ß‡∏±‡∏î", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏û‡∏•", "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥", "‡πÇ‡∏ã‡πà‡∏™‡∏∏", "‡∏≠‡∏∏‡πÑ‡∏£"];
let holidayDB = JSON.parse(localStorage.getItem('holidayDB_V7')) || {
    0: ["‡∏™‡∏°‡∏±‡∏¢", "‡∏™‡∏∏‡∏ô‡∏ó‡∏£‡∏µ", "‡∏ä‡∏±‡∏ä‡∏ä‡∏±‡∏¢", "‡∏Ç‡∏±‡∏ô‡∏ò‡∏∞‡∏•‡∏µ", "‡∏à‡∏¥‡∏£‡∏™‡∏∏‡∏î‡∏≤", "‡∏≠‡∏¥‡πà‡∏°‡∏ï‡∏µ‡πâ", "‡∏ï‡∏¥‡∏°", "‡∏£‡∏≤‡∏ì‡∏µ", "‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏†‡∏±‡∏ó‡∏£", "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥"], 
    1: ["‡∏ä‡∏•‡∏ò‡∏¥‡∏ä‡∏≤", "‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏†‡∏≤", "‡πÄ‡∏à‡∏≤‡∏∞", "‡∏•‡∏≥‡∏û‡∏π‡∏ô", "‡∏™‡∏∏‡∏ß‡∏±‡∏ô‡∏ô‡∏≤", "‡∏ä‡∏ô‡∏±‡∏ç‡∏ä‡∏¥‡∏ï‡∏≤", "‡∏≠‡∏ô‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå", "‡∏ô‡πâ‡∏≠‡∏á‡∏•‡∏±‡∏î"], 
    2: ["‡∏õ‡∏≤‡∏ì‡∏¥‡∏®‡∏£‡∏≤", "‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡∏≤", "‡∏™‡∏∏‡∏Å‡∏±‡∏ç‡∏ç‡∏≤", "‡πÄ‡∏û‡∏µ‡∏¢‡∏ö", "‡∏ß‡∏∏‡∏í‡∏¥", "‡∏õ‡∏£‡∏¥‡∏¢‡∏ô‡∏∏‡∏ä", "‡∏≠‡∏≤‡∏ó", "‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏≤", "‡∏´‡∏ô‡∏π‡∏ô‡∏¥‡∏î", "‡∏à‡∏¥‡∏î‡∏≤‡∏†‡∏≤", "‡∏à‡∏¥‡∏ï‡∏£‡∏û‡∏á‡∏©‡πå"], 
    3: ["‡πÅ‡∏û‡∏á‡∏®‡∏£‡∏µ", "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤", "‡∏û‡∏•", "‡∏ó‡∏≠‡∏á‡∏™‡∏π‡∏ô", "‡∏õ‡∏£‡∏∞‡πÑ‡∏û", "‡∏õ‡∏£‡∏∞‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÅ‡∏™‡∏á", "‡∏ò‡∏ß‡∏±‡∏ä", "‡∏õ‡∏£‡∏≤‡πÇ‡∏°‡∏ó‡∏¢‡πå", "‡∏™‡∏∏‡∏ä‡∏≤‡∏î‡∏≤", "‡∏≠‡∏ô‡∏á‡∏Ñ‡πå", "‡∏ß‡∏£‡∏£‡∏ï‡∏≤‡∏†‡∏≤", "‡∏û‡∏¥‡∏°‡∏ß‡∏î‡∏µ"], 
    4: ["‡πÅ‡∏≠‡πä‡∏∞‡πÅ‡∏≠‡πä‡∏∞", "‡∏ì‡∏¥‡∏ä‡∏≤‡∏î‡∏≤", "‡∏™‡∏°‡∏™‡∏≤‡∏¢", "‡∏™‡∏µ‡∏ô‡∏ß‡∏•", "‡∏î‡∏≤‡∏î‡πâ‡∏≤", "‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢", "‡∏•‡∏±‡∏î‡∏î‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏ö‡∏¥‡∏ß", "‡∏ô‡∏≤‡∏ß‡∏¥‡∏ô"], 
    5: ["‡∏Å‡∏£‡∏£‡∏ì‡∏¥‡∏Å‡∏≤", "‡∏ô‡πâ‡∏≥‡∏≠‡πâ‡∏≠‡∏¢", "‡∏ô‡∏¥‡∏î", "‡∏ã‡∏π‡∏•‡∏Å‡∏¥‡∏ü‡∏•‡∏µ", "‡∏ú‡πà‡∏≠‡∏á‡∏®‡∏£‡∏µ", "‡πÅ‡∏™‡∏á", "‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "‡∏ö‡∏∏‡∏ç‡∏ï‡∏≤", "‡∏û‡∏•‡∏≤‡∏Å‡∏£", "‡∏•‡∏≠‡∏¢"], 
    6: ["‡∏ß‡∏±‡∏î", "‡∏™‡∏≤‡∏¢‡πÉ‡∏à", "‡πÄ‡∏Ç‡∏°‡∏¥‡∏Å‡∏≤", "‡∏¢‡∏∏‡∏ß‡∏î‡∏µ", "‡∏ô‡∏¥‡∏ï‡∏¢‡∏≤", "‡∏õ‡∏∏‡πâ‡∏°", "‡∏ô‡∏¥‡∏î‡∏≤", "‡∏•‡∏≥‡∏î‡∏ß‡∏ô", "‡πÇ‡∏ã‡πà‡∏™‡∏∏", "‡∏≠‡∏∏‡πÑ‡∏£"]
};
let otHistory = JSON.parse(localStorage.getItem('otHistory_V7')) || {};
let isHoliday = false;
const lockedTimes = ["07:00 - 19:00 ‚è∞", "08:00 - 20:00 ‚è∞", "09:30 - 20:30 ‚è∞", "10:00 - 22:00 ‚è∞"];
const dayNames = ["‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå", "‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£", "‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò", "‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå", "‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå"];

function toggleView() {
    const main = document.getElementById('mainView');
    const settings = document.getElementById('settingsView');
    if (main.style.display === 'none') {
        main.style.display = 'block'; settings.style.display = 'none'; renderList();
    } else {
        main.style.display = 'none'; settings.style.display = 'block'; renderSettings();
    }
}

function toggleHoliday() {
    isHoliday = !isHoliday;
    document.getElementById('holidayBar').classList.toggle('active', isHoliday);
    renderList();
}

// ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡∏∑‡πà‡∏≠ (‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö)
function addItem(type) {
    if (type === 'main') {
        const val = document.getElementById('newMainStaff').value.trim();
        if (val) { mainStaff.push(val); document.getElementById('newMainStaff').value = ''; }
    } else {
        const day = document.getElementById('daySelect').value;
        const val = document.getElementById('newHolidayStaff').value.trim();
        if (val) { holidayDB[day].push(val); document.getElementById('newHolidayStaff').value = ''; }
    }
    saveData(); renderSettings();
}

function delItem(type, index) {
    if (type === 'main') mainStaff.splice(index, 1);
    else {
        const day = document.getElementById('daySelect').value;
        holidayDB[day].splice(index, 1);
    }
    saveData(); renderSettings();
}

function saveData() {
    localStorage.setItem('mainStaff_V7', JSON.stringify(mainStaff));
    localStorage.setItem('holidayDB_V7', JSON.stringify(holidayDB));
}

function renderSettings() {
    const daySelect = document.getElementById('daySelect');
    if (daySelect.options.length === 0) {
        dayNames.forEach((d, i) => daySelect.add(new Option(d, i)));
        daySelect.value = new Date().getDay();
    }
    const day = daySelect.value;
    
    let mainHtml = '';
    mainStaff.forEach((n, i) => mainHtml += `<div class="list-item">${n} <span class="btn-del" onclick="delItem('main', ${i})">[‡∏•‡∏ö]</span></div>`);
    document.getElementById('mainStaffSettings').innerHTML = mainHtml;

    let holHtml = '';
    holidayDB[day].forEach((n, i) => holHtml += `<div class="list-item">${n} <span class="btn-del" onclick="delHoliday(${i})">[‡∏•‡∏ö]</span></div>`);
    document.getElementById('holidaySettings').innerHTML = holHtml;
}
function delHoliday(i) { const day = document.getElementById('daySelect').value; holidayDB[day].splice(i, 1); saveData(); renderSettings(); }

// ‡∏£‡∏∞‡∏ö‡∏ö OT (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏Ñ‡πâ‡∏≤‡∏á‡∏•‡∏î)
let pressTimer;
function updateOT(name, action) {
    let change = action === 'dec' ? -1 : 1;
    otHistory[name] = Math.max(0, (otHistory[name] || 0) + change);
    localStorage.setItem('otHistory_V7', JSON.stringify(otHistory));
    renderList();
}
function handleOTPointer(e, name) {
    if (e.type === 'pointerdown') { pressTimer = setTimeout(() => { updateOT(name, 'dec'); pressTimer = null; }, 600); }
    else if (pressTimer) { clearTimeout(pressTimer); updateOT(name, 'inc'); pressTimer = null; }
}

function renderList() {
    const today = new Date();
    const day = today.getDay();
    document.getElementById('dateDisplay').innerText = `üìÖ ${today.toLocaleDateString('th-TH', {weekday:'long', day:'numeric', month:'long', year:'numeric'})}`;

    let otHtml = '';
    mainStaff.forEach(n => {
        let count = otHistory[n] || 0;
        otHtml += `<div class="ot-chip ${count > 0 ? 'active' : ''}" onpointerdown="handleOTPointer(event, '${n}')" onpointerup="handleOTPointer(event, '${n}')">üë§ ${n} <span class="ot-count">${count}</span></div>`;
    });
    document.getElementById('otContainer').innerHTML = otHtml;

    let html = '';
    mainStaff.forEach(name => {
        let p = "‡∏ß‡πà‡∏≤‡∏á", locked = false, customClass = "locked is-holiday";

        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î
        if (holidayDB[day] && holidayDB[day].includes(name)) { p = "üè† ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô"; locked = true; }

        // ‡∏û‡∏•: ‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ (3K) ‡πÑ‡∏°‡πà‡∏´‡∏¢‡∏∏‡∏î
        if (name === "‡∏û‡∏•") {
            if (!locked) p = "3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞";
        }

        // ‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤: ‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå‡πÑ‡∏õ ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A
        if (name === "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏≤" && isHoliday) {
            p = "‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A"; locked = true; customClass = "locked special-point"; 
        }

        if (name === "‡∏ß‡∏±‡∏î" && !locked) p = "2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞";
        if (name === "‡πÇ‡∏ã‡πà‡∏™‡∏∏" && (day !== 0 && day !== 6) && !locked) p = "2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞";

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ñ‡πâ‡∏≤‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏´‡πâ‡∏ß‡πà‡∏≤‡∏á ( - )
        const timeDisplay = locked && p.includes("‡∏´‡∏¢‡∏∏‡∏î") ? `<div style="text-align:center">-</div>` : 
            `<select class="time-sel">${lockedTimes.map(t => `<option value="${t}">${t}</option>`).join('')}</select>`;

        html += `<div class="staff-row">
            <div class="staff-name">üë§ ${name}</div>
            <div>${locked ? `<div class="${customClass}">${p}</div>` : 
                `<select class="point-sel" onchange="renderList()">
                    <option value="‡∏ß‡πà‡∏≤‡∏á">‚ö™ ‡∏ß‡πà‡∏≤‡∏á</option>
                    <option value="2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞" ${p==='2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞'?'selected':''}>üöõ 2K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞</option>
                    <option value="3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞" ${p==='3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞'?'selected':''}>üöõ 3K ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞</option>
                    <option value="2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞" ${p==='2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞'?'selected':''}>üöú 2A ‡∏ö‡πà‡∏≠‡∏Ç‡∏¢‡∏∞</option>
                    <option value="‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A" ${p==='‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A'?'selected':''}>üöΩ ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 2A</option>
                    <option value="‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô">üè† ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô</option>
                </select>`}
            </div>
            <div class="time-container">${timeDisplay}</div>
        </div>`;
    });
    document.getElementById('staffList').innerHTML = html;
}

function copyResult() {
    const today = new Date();
    let text = `üíé ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô üíé\nüìÖ ‡∏ß‡∏±‡∏ô${today.toLocaleDateString('th-TH', {weekday:'long', day:'numeric', month:'long', year:'numeric'})}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n`;
    document.querySelectorAll('.staff-row').forEach((row, i) => {
        const name = row.querySelector('.staff-name').innerText;
        const lStatus = row.querySelector('.locked');
        const p = lStatus ? lStatus.innerText : row.querySelector('.point-sel').value;
        const timeSel = row.querySelector('.time-sel');
        const timeVal = timeSel ? timeSel.value : "-";
        
        if (p.includes('‡∏´‡∏¢‡∏∏‡∏î')) text += `${i+1}. ${name} ‚ûî [ ${p} ]\n\n`;
        else text += `${i+1}. ${name} ‚ûî ${p} (${timeVal})\n\n`;
    });
    navigator.clipboard.writeText(text).then(() => alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! üöÄ"));
}
renderList();
</script>
</body>
</html>
